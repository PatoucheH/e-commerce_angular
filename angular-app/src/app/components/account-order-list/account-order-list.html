<div class="xl:col-span-1 bg-white shadow rounded-lg">
  <div class="px-6 py-4 border-b border-gray-200">
    <h2 class="text-xl font-semibold text-gray-900">Mes Commandes</h2>
  </div>

  <div class="p-6">
    <!-- Message d'erreur -->
    <div
      *ngIf="ordersError"
      class="mb-4 p-4 bg-red-50 border border-red-300 rounded-md"
    >
      <p class="text-sm text-red-700">{{ ordersError }}</p>
    </div>

    <!-- Chargement -->
    <div *ngIf="ordersLoading" class="flex justify-center py-8">
      <svg
        class="animate-spin h-8 w-8 text-blue-600"
        fill="none"
        viewBox="0 0 24 24"
      >
        <circle
          class="opacity-25"
          cx="12"
          cy="12"
          r="10"
          stroke="currentColor"
          stroke-width="4"
        ></circle>
        <path
          class="opacity-75"
          fill="currentColor"
          d="m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
        ></path>
      </svg>
    </div>

    <!-- Liste des commandes -->
    <div *ngIf="!ordersLoading && orders.length > 0" class="space-y-4">
      <div
        *ngFor="let order of orders"
        class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow duration-200"
      >
        <!-- En-tête de la commande -->
        <div class="flex justify-between items-start mb-3">
          <div>
            <p class="font-semibold text-gray-900">Commande #{{ order.id }}</p>
            <p class="text-sm text-gray-600">
              {{ formatDate(order.createdAt) }}
            </p>
          </div>
          <div class="text-right">
            <span
              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium"
              [class]="getStatusColor(order.status)"
            >
              {{ getStatusLabel(order.status) }}
            </span>
            <p class="text-lg font-semibold text-gray-900 mt-1">
              {{ order.total }}€
            </p>
          </div>
        </div>

        <!-- Adresse de livraison -->
        <div class="mb-3">
          <p class="text-sm text-gray-600">
            <span class="font-medium">Livraison :</span>
            {{ order.shippingAddress }}
          </p>
        </div>

        <!-- Bouton pour voir les détails -->
        <button
          (click)="viewOrderDetails(order)"
          class="w-full text-left px-3 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded border border-blue-200 transition-colors duration-200"
        >
          {{
            selectedOrder?.id === order.id
              ? "Masquer les détails"
              : "Voir les détails"
          }}
        </button>

        <!-- Détails de la commande (expandable) -->
        <div
          *ngIf="selectedOrder?.id === order.id"
          class="mt-4 pt-4 border-t border-gray-200"
        >
          <h4 class="font-medium text-gray-900 mb-3">Articles commandés :</h4>
          <div class="space-y-2">
            <div
              *ngFor="let item of order.items"
              class="flex justify-between items-center py-2 px-3 bg-gray-50 rounded"
            >
              <div>
                <p class="font-medium text-gray-900">
                  {{ item.productName || "Produit #" + item.productId }}
                </p>
                <p class="text-sm text-gray-600">
                  Quantité : {{ item.quantity }}
                </p>
              </div>
              <div class="text-right">
                <p class="font-semibold text-gray-900">{{ item.unitPrice }}€</p>
                <p class="text-sm text-gray-600">
                  Total : {{ item.quantity * item.unitPrice }}€
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Aucune commande -->
    <div *ngIf="!ordersLoading && orders.length === 0" class="text-center py-8">
      <div class="text-gray-400 mb-4">
        <svg
          class="mx-auto h-12 w-12"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"
          />
        </svg>
      </div>
      <p class="text-gray-500 text-lg font-medium">Aucune commande</p>
      <p class="text-gray-400 mt-1">
        Vous n'avez passé aucune commande pour le moment
      </p>
      <a
        routerLink="/products"
        class="inline-block mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors duration-200"
      >
        Découvrir nos produits
      </a>
    </div>
  </div>
</div>
